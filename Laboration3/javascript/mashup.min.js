"use strict";var maps={markers:[],map:{},lat:62,lng:15,zoom:5,init:function(e){var a=[],s=[],t=[],r=[],n=[];maps.map=new google.maps.Map(document.getElementById("map"),{center:{lat:maps.lat,lng:maps.lng},zoom:maps.zoom}),$.ajax({type:"GET",url:"./src/model/sr.json",dataType:"json",success:function(e){for(var m=0;m<e.messages.length;m++){var i=e.messages[m].createddate.split("("),o=i[1].split("+"),l=o[0];e.messages[m].createddate=l}e.messages.sort(function(e,a){return a.createddate-e.createddate});for(var m=0;m<e.messages.length;m++)0==e.messages[m].category?a.push(e.messages[m]):1==e.messages[m].category?s.push(e.messages[m]):2==e.messages[m].category?t.push(e.messages[m]):3==e.messages[m].category&&r.push(e.messages[m]),n.push(e.messages[m])}}),$("#roadTraffic").click(function(){maps.markerAndListHandler(a)}),$("#publicTransport").click(function(){maps.markerAndListHandler(s)}),$("#plannedInterference").click(function(){maps.markerAndListHandler(t)}),$("#other").click(function(){maps.markerAndListHandler(r)}),$("#allCategories").click(function(){maps.markerAndListHandler(n)})},markerAndListHandler:function(e){maps.deleteMarker(),$("#list ul li").remove(),maps.map.setZoom(maps.zoom),maps.map.setCenter(new google.maps.LatLng(maps.lat,maps.lng));for(var a=0;a<e.length;a++)maps.addMarker(e[a]);maps.infoWindow(e),$("a").click(function(){for(var e=$(this).text(),a=0;a<maps.markers.length;a++)maps.markers[a].title==e&&google.maps.event.trigger(maps.markers[a],"click")})},addMarker:function(e){var a=new google.maps.Marker({position:{lat:e.latitude,lng:e.longitude},map:maps.map,title:e.title});$("#list ul").append("<li><a href=#>"+e.title+"</a></li>"),maps.markers.push(a)},infoWindow:function(e){for(var a=new google.maps.InfoWindow,s=0;s<maps.markers.length;s++)maps.clickWindow(e[s],maps.markers[s],a)},clickWindow:function(e,a,s){var t=new Date(parseInt(e.createddate)),r=t.toString().split(" ",5),n=r[2]+" "+r[1]+" "+r[3]+", "+r[4],m=["vägtrafik","kollektivtrafik","planerad störning","övrigt","alla kategorier"],i=m[e.category],o="<h3>"+e.title+"</h3> <ul><li> Datum: "+n+" </li><li>Kategori: "+i+"</li></ul><p>"+e.description+"</p>";google.maps.event.addListener(a,"click",function(){maps.map.setZoom(9),maps.map.setCenter(a.getPosition()),s.setContent(o),s.open(maps.map,a)})},deleteMarker:function(){for(var e=0;e<maps.markers.length;e++)maps.markers[e].setMap(null);maps.markers=[]}};window.onload=maps.init;